' Gambas class file

Public Sub Buttonpegar_Click()

  TextBoxRuta.Text = Clipboard.Paste("text/plain")

  RellenarPrevisualizacionDeEnlace

End

Public Sub RellenarPrevisualizacionDeEnlace()

  Dim Textoopcional As String
  Dim ultimo As String[]
  Dim ruta As Boolean
  Dim comentario As String

  TextBoxRutaConvertida.Text = ""

  If CheckBoxTextOpcional.value = True Then
    TextoOpcional = "Enlace a "
  Else
    TextoOpcional = ""
  Endif

  If Upper(Mid(TextBoxRuta.Text, 1, 5)) = "FILE:" Then
    Try TextBoxRuta.Text = Mid(TextBoxRuta.TEXT, 6, Len(TextBoxRuta.TEXT))
  Endif

  TextBoxRuta.Text = Replace(TextBoxRuta.Text, "%20", " ")

  If IsDir(TextBoxRuta.Text) Then
    'se trata de una ruta
    comentario = "carpeta"
  Else
    comentario = "archivo"
    'se trata de un fichero
  Endif

  Try TextBoxRutaConvertida.Text = "[" & textoOpcional & TextBoxRuta.Text & "]" & convertirEnlace(TextBoxRuta.Text)

  Try ultimo = Split(TextBoxRuta.text, "/")

  If ultimo[ultimo.count - 1] = "" Then
    Try ultimo.Delete(ultimo.COUNT - 1)
  Endif

  Try TextBoxRutaConvertida.Text = "> [!Enlace a " & comentario & ": " & Replace(ultimo[ultimo.count - 1], "%20", " ") & "] \n> " & TextBoxRutaConvertida.Text

End

Public Sub Form_Open()

  Label1.Text = Application.name & " Versi√≥n: " & Application.version & "             Autor: Julio Sanchez Berro. 2023"

End

Public Function convertirEnlace(enlace As String) As String

  enlace = Replace(enlace, " ", "%20") 'convierto los espacios en %20

  Return "(file:" & enlace & ")"

End

Public Sub ButtonConvertir_Click()

  RellenarPrevisualizacionDeEnlace()
  Clipboard.Copy(TextBoxRutaConvertida.text)

End
